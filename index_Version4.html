<!DOCTYPE html>
<html>
<head>
  <title>College Attendance Tracker - Section A</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; cursor: pointer; }
    button { margin: 5px; padding: 8px 12px; }
    tr.absent { background-color: #ffffff; }
    tr.present { background-color: #c8f7c5; }
  </style>
</head>
<body>

<h2>Attendance - Section A</h2>
<p id="date">Date:</p>
<p>Enter Subject Name: <input id="subject"/></p>
<table id="attendanceTable">
  <tr>
    <th>Roll No.</th>
    <th>Student Name</th>
  </tr>
</table>

<button onclick="promptForPDFExport()">Export as PDF</button>
<button onclick="resetAttendance()">Reset</button>

<div style="position:fixed; bottom:0; right:0; opacity: 0.5; text-align:right">Created by: Karamjit Singh<br>Avnoor Singh Bal</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  // Students for Section A
  const studentsRaw = [
    "AARUSHI SETHI", "ABHAY SINGH", "ABHI VERMA", "AKARSHDEEP SINGH", "AKASHDEEP SINGH", "AMANAT SHARMA",
    "AMANDEEP KAUR", "AMRIK SINGH", "ANANYA SINGLA", "ANGEL GUPTA", "ANIKET", "ANKIT KUMAR",
    "ANMOLDEEP KAUR", "ANMOLPREET KAUR", "ANSH AHLAWAT", "ANUSHKA", "ARCHIE DHIR", "ARIHANT SHARMA",
    "ARMAAN DEORA", "ARMAANDEEP SINGH", "ARNAV CHANDEL", "ARSHDEEP SINGH", "ARSHDEEP SINGH", "ARYAN RAJ",
    "ARYANSH", "ASHIMA", "ATHARV KAUL", "AVNOOR SINGH BAL", "AVZ SHARMA", "AYUSH RAJ", "BALGOPAL RAI SINGH",
    "BARINDERPAL SINGH", "BISHAV HANS", "BHAKTI GUPTA", "BHAUMIK", "BHAVYA", "BHAVYA SHARMA", "BIRJOT KAUR",
    "CHAHAT", "CHAKSHIKA CHAWLA", "CHARU MALHOTRA", "CHAUDHARY ASHUTOSH KUMAR", "DEEPALI LUTHRA", "DEEPIKA",
    "DEVAM SAGGU", "DEVANG", "DHRUV PATHANIA", "DHRUV SHARMA", "DILJOT KAUR", "DIVYA", "DINKAR MITTAL",
    "DIPTI", "DIVJOT SINGH", "DIVJOT SINGH", "DIVYANSH", "GARIMA TRIKHA", "GARV SEHGAL", "GOUTAM KUMAR",
    "GURANGAD SINGH", "GURANSHPREET SINGH", "GURJASHAN SINGH", "GURMANNAT KAUR", "GURMEET SINGH", "GURNOOR KAUR",
    "GURNOOR SINGH", "GURNOOR SINGH", "GURPREET KAUR", "GURSAJ SINGH", "GURSEERAT KAUR", "GURSHAN SINGH",
    "GURSHAN SINGH", "GURSIMRAN SINGH", "HAETAL KATARIA", "HARANSH SINGH", "HARGUN DEEP SINGH", "HARJAP SINGH",
    "HARKIRAT SINGH RIAR", "HARMANJOT SINGH", "HARNEET KAUR", "HARNOOR KAUR", "HARSHIL GUPTA", "HARSHIL GUPTA",
    "HARSHIT MALHOTRA", "HARSHIT MOHAN SHARMA", "HARSHPREET KAUR", "HARSIDAK SINGH", "HARWINDER SINGH",
    "ISHAN SEHGAL", "ISHITA", "ISHMEET KAUR", "ISHMEET SINGH", "JAGJIT SINGH", "JAGWINDER SINGH",
    "JAHIRUL ISLAM JOY", "JAHNAVI", "JAHNVI UCHARIA", "JASDEEP KAUR", "JASHANPREET SINGH", "JASKARANJEET SINGH",
    "JASKIRAT KAUR", "JASLEEN KAUR", "JASMIN KAUR SANDHU", "JASMINE KAUR", "JASPREET KAUR", "JATIN BERI",
    "JITISH MONGA", "KARAMJIT SINGH", "KARAN SINGH", "KARSIMRAN SINGH", "KASHIKA", "KAVYA ARORA", "KESHAV PURI",
    "KHUSHAAN LAL", "KHUSHI MEHTA", "KHUSHPREET SINGH", "KIRT PAUL", "KOMALPREET KAUR", "KRISH BHAGAT",
    "KRISH GUMBER", "KRISH KUMAR", "KRISH NAYYAR", "KRISHAN CHOPRA", "KRISHI SONDHI", "KRISHNA",
    "KRITAGAYA BHATIA", "KRITIKA MEHTA", "KUNAL", "KUSHAGRAH JAIN"
  ];
  const duplicateSuffix = {
    "ARSHDEEP SINGH": ["4654", "2374"], "DIVJOT SINGH": ["4304", "1522"], "GURNOOR SINGH": ["3550", "5591"],
    "GURSHAN SINGH": ["1755", "0584"], "HARSHIL GUPTA": ["2273", "5023"]
  };
  const nameCount = {};
  studentsRaw.forEach(name => { nameCount[name] = (nameCount[name] || 0) + 1; });
  const students = [];
  const dupSeen = {};
  studentsRaw.forEach(name => {
    if (nameCount[name] === 1) { students.push([name]); } else {
      if (!dupSeen[name]) dupSeen[name] = 0;
      const suffixArr = duplicateSuffix[name];
      let displayName = name;
      if (suffixArr && dupSeen[name] < suffixArr.length) {
        displayName = `${name} (${suffixArr[dupSeen[name]]})`;
        dupSeen[name]++;
      } else {
        displayName = `${name} (${1000 + dupSeen[name]})`;
        dupSeen[name]++;
      }
      students.push([displayName]);
    }
  });

  const dateObj = new Date();
  const y = dateObj.getFullYear();
  const m = dateObj.getMonth()+1;
  const d = dateObj.getDate();
  document.getElementById("date").innerHTML += `${d}/${m}/${y}`;

  const table = document.getElementById("attendanceTable");
  students.forEach(([name], index) => {
    const row = table.insertRow();
    row.insertCell().textContent = index + 1;
    row.insertCell().textContent = name;
    row.classList.add("absent");
    row.addEventListener("click", () => {
      row.classList.toggle("present");
      row.classList.toggle("absent");
    });
  });

  function getPresent() {
    return Array.from(table.rows).slice(1)
      .filter(row => row.classList.contains("present"))
      .map(row => `${row.cells[0].textContent}. ${row.cells[1].textContent}`);
  }

  function getAbsent() {
    return Array.from(table.rows).slice(1)
      .filter(row => row.classList.contains("absent"))
      .map(row => `${row.cells[0].textContent}. ${row.cells[1].textContent}`);
  }

  function promptForPDFExport() {
    const password = prompt("Please enter the password to export as PDF:");
    if (password === "@exportPDF") {
      exportPDF();
    } else if (password !== null) {
      alert("Incorrect password.");
    }
  }

  function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const present = getPresent();
    const absent = getAbsent();
    const pageHeight = doc.internal.pageSize.getHeight();
    const pageWidth = doc.internal.pageSize.getWidth();
    let yPos = 30;
    const lineHeight = 7;

    doc.setTextColor(0, 0, 0);
    doc.text("Subject: " + document.getElementById("subject").value, 10, 10);
    doc.text(("Date: " + d + "/" + m + "/" + y), 10, 17);
    doc.text(`Present: ${present.length}, Absent: ${absent.length}, Total: ${students.length}`, 10, 24);

    doc.text("Present Students:", 10, yPos); yPos += lineHeight;
    doc.setTextColor(0, 128, 0);
    present.forEach(line => {
      if (yPos > pageHeight - 20) { doc.addPage(); yPos = 20; }
      doc.text(line, 10, yPos); yPos += lineHeight;
    });

    yPos += lineHeight;
    doc.setTextColor(0, 0, 0);
    doc.text("Absent Students:", 10, yPos); yPos += lineHeight;
    doc.setTextColor(255, 0, 0);
    absent.forEach(line => {
      if (yPos > pageHeight - 20) { doc.addPage(); yPos = 20; }
      doc.text(line, 10, yPos); yPos += lineHeight;
    });

    doc.setTextColor(0, 0, 0);
    const watermarkText = "Created by: Karamjit Singh, Avnoor Singh Bal";
    doc.setFontSize(10);
    const textWidth = doc.getTextWidth(watermarkText);
    doc.text(watermarkText, pageWidth - textWidth - 10, pageHeight - 10);

    doc.save("attendance.pdf");
  }

  function resetAttendance() {
    Array.from(table.rows).slice(1).forEach(row => {
      row.classList.remove("present");
      row.classList.add("absent");
    });
  }
</script>
</body>
</html>