<!DOCTYPE html>
<html>
<head>
  <title>College Attendance Tracker - Section B</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; cursor: pointer; }
    button { margin: 5px; padding: 8px 12px; }
    tr.absent { background-color: #ffffff; }
    tr.present { background-color: #c8f7c5; }
  </style>
</head>
<body>

<h2>Attendance - Section B</h2>
<p id="date">Date:</p>
<p>Enter Subject Name: <input id="subject"/></p>
<table id="attendanceTable">
  <tr>
    <th>Roll No.</th>
    <th>Student Name</th>
  </tr>
</table>

<button onclick="promptForPDFExport()">Export as PDF</button>
<button onclick="resetAttendance()">Reset</button>

<div style="position:fixed; bottom:0; right:0; opacity: 0.5; text-align:right">Created by: Karamjit Singh<br>Avnoor Singh Bal</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
  // Students for Section B
  const studentsRaw = ['2025010001091', 'LAKSHDEEP SINGH'],
  ['2025010000690', 'MALHAR ARORA'],
  ['2024010017022', 'MANASVI'],
  ['2025010002576', 'MANJOT KAUR'],
  ['2025010002655', 'MANJOT SINGH'],
  ['2025010012344', 'MANPAWAN KAUR'],
  ['2025010010100', 'MANPREET KUMAR'],
  ['2025010000791', 'MANRAJDEEP SINGH'],
  ['2024010149119', 'MANTHAN ATTRI'],
  ['2025010002828', 'MANTHAN SHARMA'],
  ['2025010002081', 'MEHAK GUPTA'],
  ['2024010012927', 'MEHAK PADWAL'],
  ['2025010005777', 'MEHAKDEEP KAUR'],
  ['2025010002630', 'MEHAKPREET SINGH'],
  ['2025010000318', 'MEHAR JOLLY'],
  ['2025010002210', 'MISHTHI'],
  ['2025010003062', 'MITHILESHWAR'],
  ['2025010000134', 'MOHIT'],
  ['2025010007933', 'MOHIT SALWAN'],
  ['2025010014787', 'MOHIT SINGH'],
  ['2025010000548', 'MOULIK YADAV'],
  ['2025010003170', 'MR SAKSHAM'],
  ['2025010002913', 'MRIDULA'],
  ['2025010001166', 'MUSKAN'],
  ['2025010000256', 'NANDANI GARG'],
  ['2025010002170', 'NANDINI RATHORE'],
  ['2025010015257', 'NAVDEEP KAUR'],
  ['2025010005696', 'NAVJIT KAPIL'],
  ['2025010000174', 'NAVJOT KAUR'],
  ['2025010011633', 'NAVNEET KAUR'],
  ['2025010013293', 'NAVREET KAUR'],
  ['2025010005662', 'NAVYA'],
  ['2025010001449', 'NEELESH KALIA'],
  ['2025010007705', 'NIMISH SURI'],
  ['2025010015387', 'NIRJALA'],
  ['2025010004261', 'NITISH'],
  ['2025010013506', 'PALAK SHARMA'],
  ['2025010012827', 'PAVITERPREET SINGH'],
  ['2025010001990', 'PAVNEET SINGH'],

  // Page 5 Data
  ['2025010003616', 'PRABHNOOR KAUR'],
  ['2025010010754', 'PRABHNOOR SINGH'],
  ['2025010011756', 'PRANAV JOSHI'],
  ['2025010002521', 'PRINCE KUMAR'],
  ['2025010012252', 'PRITIKA'],
  ['2025010006991', 'PRIYANSH'],
  ['2025010000782', 'RAGHAV SHARMA'],
  ['2025010009086', 'RAGHUNANDAN'],
  ['2025010001824', 'RAHUL SHARMA'],
  ['2025010007141', 'RANVIR SINGH'],
  ['2025010014793', 'RASHMITA'],
  ['2025010006422', 'RAVDEEP KAUR'],
  ['2025010015608', 'RAYAN CHANDEL'],
  ['2025010003151', 'REHAN SINGH'],
  ['2025010009937', 'RIDHAMPREET SINGH'],
  ['2025010015803', 'RISHITA'],
  ['2025010015872', 'RIVANSHU BEHAL'],
  ['2025010001216', 'ROHINI SHARMA'],
  ['2025010013653', 'ROHIT KUMAR'],
  ['2025010004822', 'ROOPANSHI SHARMA'],
  ['2025010006224', 'RUDRAKSH MEHRA'],
  ['2025010012621', 'RUDRAKSH SHARMA'],
  ['2025010013723', 'RUHI'],
  ['2025010006410', 'SACHIN KUMAR'],
  ['2025010016050', 'SAHEJVEER SINGH'],
  ['2024010149114', 'SAHIBPREET SINGH'],
  ['2025010014956', 'SAHIL GUPTA'],
  ['2025010004367', 'SAKSHAM GUPTA'],
  ['2025010003974', 'SAMAIRA'],
  ['2025010001134', 'SAMRIDHI SHARMA'],
  ['2025010006202', 'SANCHI SHARMA'],
  ['2025010000040', 'SANYAM GAUTAM'],
  ['2025010001393', 'SATYAK GUPTA'],
  ['2025010012011', 'SAWAL PUSHKARNA'],
  ['2025010015232', 'SAWNI'],
  ['2025010005079', 'SHAGUN KAUR'],
  ['2025010011577', 'SHASHANK SHEKHAR'],
  ['2025010016417', 'SHATRUNJAY SINGH'],
  ['2025010005778', 'SHAURYA THAKUR'],

  // Page 6 Data
  ['2025010004908', 'SHIVANG GUPTA'],
  ['2025010003077', 'SHIVANSH SHUKLA'],
  ['2025010001215', 'SHIVJOT SINGH'],
  ['2025010001020', 'SHREYANSH'],
  ['2025010007912', 'SIDARTH ATTRI'],
  ['2025010004098', 'SIRTAJ SINGH'],
  ['2025010013820', 'SIYA'],
  ['2025010004303', 'SOURAV'],
  ['2025010005215', 'SUKHMANI'],
  ['2025010004104', 'SUKHMANJEET SINGH'],
  ['2025010014755', 'SUKHMANPREET'],
  ['2025010001761', 'SUKHPAL SINGH'],
  ['2025010013996', 'SUNAKSHI MEHTA'],
  ['2025010015464', 'SUNDRAM KUMAR'],
  ['2025010001933', 'SUNIDHI SOOD'],
  ['2025010014888', 'SURYA DEY'],
  ['2025010003288', 'SUSHANK BALHOTRA'],
  ['2025010008169', 'SUSHEN GUPTA'],
  ['2025010032316', 'TANDRIKA RANI KUNDU'],
  ['2025010003334', 'TANMYA MAHAJAN'],
  ['2025010006879', 'TEJ AL CHOPRA'],
  ['2025010008350', 'TRIBHUVAN SINGH'],
  ['2025010011718', 'TUSHAAR'],
  ['2025010007466', 'UJWAL'],
  ['2024010013164', 'UTTAMPREET KAUR'],
  ['2025010009626', 'VAIBHAV MAHAJAN'],
  ['2025010001634', 'VAISHALI KUNDAL'],
  ['2025010014996', 'VARENYA MAHAJAN'],
  ['2025010001766', 'VARUN ALOONA'],
  ['2025010015149', 'VENU GOPAL'],
  ['2025010007238', 'VINEET KUMAR'],
  ['2024010003797', 'VINOD PARMAR'],
  ['2025010009078', 'VISHAL CHOUDHARY'],
  ['2025010005793', 'VISHESH KUMAR'],
  ['2025010000492', 'YASHIKA'],
  ['2025010010003', 'YOGITA'],
  ['2025010007860', 'YUVRAJ JASSI'],
  ['17032400065', 'JATIN']
];
  const nameCount = {};
  studentsRaw.forEach(name => { nameCount[name] = (nameCount[name] || 0) + 1; });
  const dupSeen = {};
  const students = studentsRaw.map(name => {
    if (nameCount[name] === 1) { return [name]; }
    else { dupSeen[name] = (dupSeen[name] || 0) + 1; return [`${name} (${dupSeen[name]})`]; }
  });

  const dateObj = new Date();
  const y = dateObj.getFullYear();
  const m = dateObj.getMonth()+1;
  const d = dateObj.getDate();
  document.getElementById("date").innerHTML += `${d}/${m}/${y}`;

  const table = document.getElementById("attendanceTable");
  students.forEach(([name], index) => {
    const row = table.insertRow();
    row.insertCell().textContent = index + 1;
    row.insertCell().textContent = name;
    row.classList.add("absent");
    row.addEventListener("click", () => {
      row.classList.toggle("present");
      row.classList.toggle("absent");
    });
  });

  function getPresent() {
    return Array.from(table.rows).slice(1)
      .filter(row => row.classList.contains("present"))
      .map(row => `${row.cells[0].textContent}. ${row.cells[1].textContent}`);
  }

  function getAbsent() {
    return Array.from(table.rows).slice(1)
      .filter(row => row.classList.contains("absent"))
      .map(row => `${row.cells[0].textContent}. ${row.cells[1].textContent}`);
  }
  
  function promptForPDFExport() {
    const password = prompt("Please enter the password to export as PDF:");
    if (password === "@Bsec") {
      exportPDF();
    } else if (password !== null) {
      alert("Incorrect password.");
    }
  }

  function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const present = getPresent();
    const absent = getAbsent();
    const pageHeight = doc.internal.pageSize.getHeight();
    const pageWidth = doc.internal.pageSize.getWidth();
    let yPos = 30;
    const lineHeight = 7;

    doc.setTextColor(0, 0, 0);
    doc.text("Subject: " + document.getElementById("subject").value, 10, 10);
    doc.text(("Date: " + d + "/" + m + "/" + y), 10, 17);
    doc.text(`Present: ${present.length}, Absent: ${absent.length}, Total: ${students.length}`, 10, 24);

    doc.text("Present Students:", 10, yPos); yPos += lineHeight;
    doc.setTextColor(0, 128, 0);
    present.forEach(line => {
      if (yPos > pageHeight - 20) { doc.addPage(); yPos = 20; }
      doc.text(line, 10, yPos); yPos += lineHeight;
    });

    yPos += lineHeight;
    doc.setTextColor(0, 0, 0);
    doc.text("Absent Students:", 10, yPos); yPos += lineHeight;
    doc.setTextColor(255, 0, 0);
    absent.forEach(line => {
      if (yPos > pageHeight - 20) { doc.addPage(); yPos = 20; }
      doc.text(line, 10, yPos); yPos += lineHeight;
    });

    doc.setTextColor(0, 0, 0);
    const watermarkText = "Created by: Karamjit Singh, Avnoor Singh Bal";
    doc.setFontSize(10);
    const textWidth = doc.getTextWidth(watermarkText);
    doc.text(watermarkText, pageWidth - textWidth - 10, pageHeight - 10);

    doc.save("attendance.pdf");
  }

  function resetAttendance() {
    Array.from(table.rows).slice(1).forEach(row => {
      row.classList.remove("present");
      row.classList.add("absent");
    });
  }
</script>
</body>

</html>

